async function endGame(){
  try {
    // 1. Verifica se j√° existe o jogador no ranking
    const { data: existing, error: fetchError } = await db
      .from('ranking')
      .select('id, score')
      .eq('username', name)
      .maybeSingle();

    if (fetchError) {
      console.error('Erro ao buscar jogador:', fetchError);
    } else if (existing) {
      // 2. Se j√° existe e a nova pontua√ß√£o for maior ‚Üí atualiza
      if (score > existing.score) {
        const { error: updateError } = await db
          .from('ranking')
          .update({ score })
          .eq('id', existing.id);

        if (updateError) console.error('Erro ao atualizar pontua√ß√£o:', updateError);
      }
    } else {
      // 3. Se n√£o existe, insere novo
      const { error: insertError } = await db
        .from('ranking')
        .insert([{ username: name, score }]);

      if (insertError) console.error('Erro ao inserir pontua√ß√£o:', insertError);
    }
  } catch (e) {
    console.error('Falha ao conectar no Supabase', e);
  }

  // Mostra resultado e chama ranking
  document.body.innerHTML = `
    <div class="container">
      <header>
        <div class="brand"><h1>Resultado üéâ</h1></div>
        <div class="sub">Obrigado por jogar, ${name}!</div>
      </header>
      <div class="card row center">
        <div style="font-size:2.2rem; font-weight:800">Voc√™ fez ${score} / ${total}</div>
        <div class="small">Sua pontua√ß√£o foi salva no ranking.</div>
        <div class="grid-2">
          <a class="btn warn" href="./index.html">Jogar novamente</a>
          <a class="btn success" href="./ranking.html">Ver Ranking üèÜ</a>
        </div>
      </div>
    </div>
  `;
}
